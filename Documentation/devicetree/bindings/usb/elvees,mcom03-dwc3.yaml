# SPDX-License-Identifier: GPL-2.0
%YAML 1.2
---
$id: http://devicetree.org/schemas/usb/elvees,mcom03-dwc3.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: ELVEES MCom-03 USB Controller

description:
  To function correctly requires "snps,dis_u2_susphy_quirk" property in child
  DWC3 node.

properties:
  compatible:
    const: elvees,mcom03-dwc3

  "#address-cells":
    enum: [ 1, 2 ]

  "#size-cells":
    enum: [ 1, 2 ]

  ranges: true

  clocks:
    description:
      A list of phandle and clock-specifier pairs for the clocks
      listed in clock-names.
    items:
      - description: system clock
      - description: ref clock
      - description: suspend clock, used for usb wakeup logic

  clock-names:
    items:
      - const: sys
      - const: ref
      - const: suspend

  elvees,urb:
    description:
      A phandle to the syscon node describing URB registers.
    $ref: /schemas/types.yaml#/definitions/phandle

  elvees,ctrl-id:
    description:
      ID of the controller. It's used to calculate offsets of registers in URB.
    enum: [ 0, 1 ]

  resets:
    minItems: 1

# Required child node:

patternProperties:
  "^usb@[0-9a-f]+$":
    $ref: snps,dwc3.yaml#

required:
  - compatible
  - "#address-cells"
  - "#size-cells"
  - ranges
  - clocks
  - clock-names
  - elvees,ctrl-id
  - elvees,urb
  - resets

additionalProperties: false

examples:
  - |
    #include <dt-bindings/soc/elvees,mcom03.h>

    usb0: usb@10000000 {
        #address-cells = <2>;
        #size-cells = <2>;
        ranges;
        compatible = "elvees,mcom03-dwc3";
        clock-names = "sys", "ref", "suspend";
        clocks = <&usb_sys_clk>, <&usb_ref_clk>, <&usb_suspend_clk>;
        resets = <&hsperiph_reset HSPERIPH_RST_USB0>;
        elvees,urb = <&hsperiph_urb>;
        elvees,ctrl-id = <0>;

        dwc3@10000000 {
            compatible = "snps,dwc3";
            reg = <0 0x10000000 0 0x100000>;
            interrupts = <GIC_SPI 9 IRQ_TYPE_LEVEL_HIGH>;
            snps,dis_u2_susphy_quirk;
        };
    };
